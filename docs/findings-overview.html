<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Residential Property Values Analysis</title>

<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/bootstrap.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>






<link rel="stylesheet" href="style.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.tab('show');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Impacts of Broadband Development on Rural Property Values</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Overview</a>
</li>
<li>
  <a href="data.html">Data</a>
</li>
<li>
  <a href="methods.html">Ookla Speedtest Analysis</a>
</li>
<li>
  <a href="findings-overview.html">Residential Property Values Analysis</a>
</li>
<li>
  <a href="team.html">Team</a>
</li>
<li>
  <a href="https://github.com/dcc7ffm/dspg-ers">
    <span class="fa fa-github"></span>
     
    
  </a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">



<h1 class="title toc-ignore">Residential Property Values Analysis</h1>

</div>


<div id="literature-review" class="section level1">
<h1>Literature Review</h1>
<p>We conducted a literature review of journals that analyzed the effects of high-speed internet access and property prices. </p>
<div id="home-is-where-the-internet-is-high-speed-internets-impact-on-rural-housing-values" class="section level3">
<h3>Home Is Where the Internet Is? High-speed Internet’s Impact on Rural Housing Values </h3>
<div id="kelsey-l.-conley-and-brian-e.-whitacre" class="section level5">
<h5>Kelsey L. Conley and Brian E. Whitacre </h5>
<p>This report uses data from the National Broadband Map, the Federal Communications Commission, and over 2,700 housing transactions from June 2011 to June 2017 to examine the impact of broadband availability on housing values in two rural Oklahoma counties via a hedonic price model. The results find no support for the existence of a broadband premium, and stress that differences across counties are crucial in assessing rural housing prices. The full report can be found at <a href="https://doi.org/10.1177/0160017620918652">this link</a>. </p>
</div>
</div>
<div id="high-speed-internet-access-and-housing-values" class="section level3">
<h3>High-speed Internet access and housing values</h3>
<div id="gabor-molnar-scott-j.-savage-and-douglas-c.-sicker" class="section level5">
<h5>Gabor Molnar, Scott J. Savage, and Douglas C. Sicker</h5>
<p>This report uses a hedonic regression model that relates house values to high-speed Internet access while controlling for the potential endogeneity of Internet access. Results show that single-family homes with access to a 25 Mbps broadband connection have a price that is about $5,977, or 3%, more than similar homes in neighborhoods with 1 Mbps. The rural premium is lower at $5,099. The full report can be found at <a href="https://doi.org/10.1080/00036846.2019.1631443">this link</a>.</p>
</div>
</div>
</div>
<<<<<<< HEAD
<div id="exploratory-data-analysis-of-corelogic-property-tax-data" class="section level1">
<h1>Exploratory Data Analysis of CoreLogic Property Tax Data</h1>
<p><img src="/home/kno5cac/git/dspg-ers/src/web/www/Website/CL_EDA.png" alt="EDA of CoreLogic" /> <img src="/home/kno5cac/git/dspg-ers/src/web/www/Website/CL_EDA_highlights.png" alt="EDA of CoreLogic with highlights" /></p>
<div id="sales-price-vs-assessed-price-correlation" class="section level3">
<h3>Sales Price vs Assessed Price Correlation</h3>
<p>x</p>
</div>
</div>
<div id="project-area-selection" class="section level1">
<h1>Project Area Selection</h1>
<p>t</p>
<p>The BIP projects shown below represent a subset of the 132 BIP projects for which the data was</p>
<p>The CoreLogic data</p>
=======
<div id="project-area-selection" class="section level1">
<h1>Project Area Selection</h1>
<p>For this analysis, we used a subset of the CoreLogic data, which included data for the eight states with the highest number of properties in the data: Arkansas, California, Colorado, Florida, Georgia, North Carolina, Ohio, and Texas. To select the project area for our analysis, we calculated the counts of properties inside the project area and outside the project area by a radius of 20 miles, both before and after the project was implemented. This was completed by correlating the latitude/longitude of each property to the project shapefiles and finding the properties that intersected using the sf package in R. The counts are presented in the table below for a subset of the 132 BIP projects that were present in one of the eight states in the CoreLogic data.</p>
>>>>>>> 05ca5b8e07c71cfb01f156cd146ea33552b2b9c3
<pre class="r"><code>state8_counts &lt;- read.csv(&quot;www/state8_counts&quot;)
state8_counts[,2:8]</code></pre>
<pre><code>##         BIP_ID tot_in_20m tot_out_20m bef_in_20m bef_out_20m aft_in_20m
## 1  AR1102-AG39        196       25762          0          45        196
## 2   CA1107-B40       3450      231602          0        1984       3450
## 3   CA1110-A40          0      208662          0          59          0
## 4   CA1112-A40          0       84220          0          12          0
## 5   CA1113-A40     112620     2390368          8        1099     112620
## 6   CA1114-A40      49153     6635504          4        2583      49153
## 7   CA1115-A40      17844       62734          1           0      17844
## 8   CO1106-A40       1747       63464          0          42       1747
## 9   CO1107-A40       2846      930471          3          46       2846
## 10  CO1108-B39      35731      206466          3           7      35731
## 11  CO1109-A40         89       73694          0          12         89
## 12  CO1110-A40         49        4954          0           0         49
## 13  CO1114-A40         77       52637          0          12         77
## 14  FL1105-A40      18569     2888348         57       21243      18512
## 15  GA1105-A40       7199      453800         13         614       7186
## 16  GA1107-A40          8       97332          0           7          8
## 17  GA1109-C40       2201       12151          4           7       2201
## 18  NC1103-A40          0      466492          0         398          0
## 19  NC1105-A40          0      110710          0           0          0
## 20  NC1106-A40      16579      385708          0          20      16579
## 21  NC1107-B40      16892      486199          0        1075      16892
## 22  NC1108-A40       8872      522083          0          39       8872
## 23  NC1109-A40      15140     1322566          0         150      15140
## 24  NC1110-A40          0       65805          0           9          0
## 25  OH1106-A40      22048     2891452        910       44797      21138
## 26  OH1107-A40       1147      241801          0           1       1147
## 27  OH1108-A40      56058     2834094          0          34      56058
## 28  OH1110-B40      12447      243845          0           4      12447
## 29  OH1111-A40       1095      242735          0           2       1095
## 30  TX1113-A40        394      385529          0        6926        394
## 31  TX1116-A40          0          50          0           0          0
## 32  TX1119-A40         36      356593          0           0         36
## 33  TX1120-A40       1774      238414          0           3       1774
## 34  TX1122-A40          9       12347          0           0          9
##    aft_out_20m
## 1        25717
## 2       229618
## 3       208662
## 4        84220
## 5      2390368
## 6      6635504
## 7        62734
## 8        63422
## 9       930471
## 10      206466
## 11       73694
## 12        4954
## 13       52637
## 14     2867105
## 15      453186
## 16       97332
## 17       12151
## 18      466094
## 19      110710
## 20      385708
## 21      486199
## 22      522083
## 23     1322566
## 24       65805
## 25     2846655
## 26      241801
## 27     2834094
## 28      243845
## 29      242735
## 30      378603
## 31          50
## 32      356593
## 33      238414
## 34       12347</code></pre>
<<<<<<< HEAD
<img src="www/Website/contingency_before.png" style="width:80.0%" />
</center>
<p><img src="www/Rplot.png" style="width:80.0%" /></right> <img src="www/Website/map_before.png" style="width:80.0%" /></right></p>
</div>
<div id="model" class="section level1">
<h1>Model</h1>
<div id="data-cleaning" class="section level3">
<h3>Data Cleaning</h3>
</div>
=======
<p>Broadband Initiative Project OH1106-A40 is one of the few project areas that has sufficient data from this specific CoreLogic dataset, so our analysis will be based upon the properties and their prices and characteristics within this project area. The OH1106-A40 project shapefile and plot of properties inside (green) and outside (orange) are presented below.</p>
<p><img src="www/Rplot.png" style="width:60.0%" /></left> <img src="www/map_before.png" style="width:60.0%" /></right></p>
</div>
<div id="model" class="section level1">
<h1>Model</h1>
>>>>>>> 05ca5b8e07c71cfb01f156cd146ea33552b2b9c3
<div id="variable-selection" class="section level3">
<h3>Variable Selection</h3>
<div id="dependent-variable-sales-price-vs-assessed-price" class="section level4">
<h4>Dependent Variable: Sales Price vs Assessed Price</h4>
<p>Our initial analysis was focused on assessing changes in property prices using the sale value as the dependent variable. However, the data of sales values are largely incomplete with a completeness percentage of 65.90% as shown by the exploratory data analysis in the Data page. We shifted our dependent variable from sale value to the assessed values of the properties. The assessed values are calculated by county-level tax offices that conduct these assessments on a regular basis, varying by tax office. The assessed values had a completeness percentage of 99.41%, ensuring that our analysis could use most of the data. <br> <br> To establish that assessed values could serve as a good proxy for sales values within Ohio, we calculated the correlation between the medians and means of the two variables at the ZIP code level by year. We removed ZIP codes that had less than 40 observations within a given year. The correlation between the median and mean values were both strong and positive, with a correlation coefficient of 0.938 and 0.961, respectively. We plotted these points and overlayed it with a LOESS (locally weighted smoothing) regression shown below. We can confidently use assessed prices as the dependent variable of our analysis.</p>
<p><img src="www/ohiomedian.png" style="width:40.0%" /></left> <img src="www/ohiomean.png" style="width:40.0%" /></right></p>
</div>
<div id="independent-variable-manipulation" class="section level4">
<h4>Independent Variable Manipulation</h4>
<div id="age-age" class="section level5">
<h5>Age (age)</h5>
<p>CoreLogic provides the year built and effective year built of properties, where the year built represents the initial property building year, and the effective year represents year where substantial renovation was completed to the property. Thus, we created a new variable that represented the most recent year built, i.e., if the property had an effective year built, then this value was used; otherwise, the initial year built was used. We then subtracted this value from the assessed year, which would give us the age of the property when the home was assessed. For example, if the home was assessed in 2009, and the home was renovated in 1993, the age of the home would be 16 years at the time of assessment. This age variable is used in our model.</p>
</div>
<div id="distance-distance_miles" class="section level5">
<h5>Distance (distance_miles)</h5>
<p>The distance is a main effect variable which calculates the distance of the property to the closest border of the project area, which was calculated using the shapefiles. Properties inside of the project areas have a negative distance while properties outside have a positive distance. This will be used to assess whether the program had an effect on property prices before/after the project was implemented. This distance_miles variable is used in our model.</p>
</div>
<div id="living-area-to-land-ratio-sqft_ratio-living_square_feet-land_square_footage" class="section level5">
<h5>Living Area to Land ratio (sqft_ratio, living_square_feet, land_square_footage)</h5>
<p>The ratio of the living area (square feet) to the land area (square feet) was taken to create the variable sqft_ratio. sqft_ratio, living_square_feet and land_square_footage are all used in our model.</p>
</div>
</div>
<div id="dummy-variables" class="section level4">
<h4>Dummy Variables</h4>
<div id="insideoutside-project-area-dummy_out_in" class="section level5">
<h5>Inside/Outside Project Area (dummy_out_in)</h5>
<p>To specify whether a property is inside or outside of the project area, we created dummy variable dummy_out_in where 0 represents a property outside of the project area and 1 represents a property inside the project area. This was created using the project area shapefiles.</p>
</div>
<div id="beforeafter-project-implementation-dummy_before_after" class="section level5">
<h5>Before/After Project Implementation (dummy_before_after)</h5>
<p>To specify whether a property's value was before or after the project was implemented, we created dummy variable dummy_before_after where 0 represents an assessment before project implementation and 1 represents an assessment after project implementation. The OH1106-A40 project was implemented in 2010, so assessment values leading up to and including 2010 correspond to a 0 and assessment values after 2010 correspond to a 1.</p>
</div>
<div id="mobile-home-and-fireplace-dummy_mobile_home_ind-dummy_fire_place" class="section level5">
<h5>Mobile Home and Fireplace (dummy_mobile_home_ind, dummy_fire_place)</h5>
<p>The CoreLogic data has indicators for whether a property is a mobile home or has a fireplace. Thus, we create dummy variable where 1 represents that it is a mobile home or has a fireplace, and 0 if it is not a mobile home or doesn't include a fireplace. Variables dummy_mobile_home_ind and dummy_fire_place are included in our model.</p>
</div>
</div>
<div id="factor-variables-factor_bedrooms-factor_total_baths_calculated-factor_number_of_units-factor_stories_number" class="section level4">
<h4>Factor Variables (factor_bedrooms, factor_total_baths_calculated, factor_number_of_units, factor_stories_number)</h4>
<p>CoreLogic data includes values for the number of bedrooms, bathrooms, units, and stories that each property has. These are all discrete variables and have varying distributions as seen on the boxplots to the left. These are all transformed to factor variables with fewer levels. The factor variable distributions should have near normal distributions, which is true for these variables, not including the number of stories. Variables factor_bedrooms, factor_total_baths_calculated, factor_number_of_units, and factor_stories_number are all used in our model.</p>
<p><img src="www/Website/bedrooms.png" alt="bedrooms" style="width:45.0%" /></left> <img src="www/Website/factor_bedrooms.png" alt="factor_bedrooms" style="width:45.0%" /></right> <img src="www/Website/total_baths_calculated.png" alt="total_baths_calculated" style="width:45.0%" /></left> <img src="www/Website/factor_total_baths_calculated.png" alt="factor_total_baths_calculated" style="width:45.0%" /></right> <img src="www/Website/number_of_units.png" alt="number_of_units" style="width:45.0%" /></left> <img src="www/Website/factor_number_of_units.png" alt="factor_number_of_units" style="width:45.0%" /></right> <img src="www/Website/stories_number.png" alt="stories_number" style="width:45.0%" /></left> <img src="www/Website/factor_stories_number.png" alt="factor_stories_number" style="width:45.0%" /></right></p>
</div>
<div id="interactions-dummy_in_after_interaction-distance_after_interaction-distance_in_after_interaction." class="section level4">
<h4>Interactions (dummy_in_after_interaction, distance_after_interaction, distance_in_after_interaction.)</h4>
<p>Finally, we create three interactions between variables. The first interaction variable is dummy_in_after_interaction, an interaction between dummy_out_in and dummy_before_after. Thus, the observations will be valued at 1 if they are both inside the project area and after the project implementation. This variable is the main effect variable, and we will use the coefficient and p-value of this variable to determine the impact of the broadband initiative project. <br> <br> The next interaction variables are distance_after_interaction and distance_in_after_interaction. Interaction variable distance_in_after_interaction represents an interaction between the distance_miles and dummy_out_in and dummy_before_after. Thus, in a similar fashion to dummy_in_after_interaction, distance_in_after_interaction represents the effect on property prices for properties inside and after project implementation, magnified by the distance of the property to the project boundary. This variable is also the main effect variable, and we will use the coefficient and p-value of this variable to determine the impact of the broadband initiative project, although in a seperate model from the dummy_in_after_interaction variable.</p>
</div>
<div id="data-cleaning" class="section level4">
<h4>Data Cleaning</h4>
<p>After selecting and manipulating the variables, duplicated and incomplete property observations were deleted. Our final dataset had 137558 observations, compared to 289184 before the data was cleaned. The distribution of these properties by inside/outside the project area and before/after project implementation are shown in the contingency matrices below.</p>
<img src="www/Website/contingency_before.png" style="width:80.0%" />
</center>
<img src="www/Website/contingency_after.png" style="width:100.0%" />
</center>
</div>
</div>
<div id="final-model" class="section level3">
<h3>Final Model</h3>
<p><img src="www/dummy.png" style="width:45.0%" /></left> <img src="www/distance.png" style="width:45.0%" /></right></p>
</div>
<div id="conclusion" class="section level3">
<h3>Conclusion</h3>
<p>x</p>
</div>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
